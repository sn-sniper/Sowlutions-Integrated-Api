function ValidateEmail(str) {
  if (!str || str.length > 256) return "Please Enter a valid email."; // check if string email then 256 character.

  let atCount = 0; // count of the @ char
  let atIndex = -1; // index of the @ char
  let dotAfterAt = false; // if there is a '.' after the @
  let lastDotIndex = -1; // last index of the last '.'

  for (let i = 0; i < str.length; i++) {
    const ch = str[i]; //char on each index

    // if the character is @ then the @count increases and the index updates
    if (ch === "@") {
      atCount++;
      atIndex = i;

      // if @ found at start or at the end, then it returns false
      if (i === 0 || i === str.length - 1) return false;

      // if there is more than 1 @ it returns false
      if (atCount > 1) return false;
    }

    // if the '.' is after the @ then the dotAfterAt will turn true and it's index is saved
    if (ch === "." && atIndex !== -1 && atIndex < i) {
      dotAfterAt = true;
      lastDotIndex = i;
      if (str[i - 1] === "@" || str[i + 1] === "@" || lastDotIndex === 0 || lastDotIndex === str.length - 1) return false; // return false if immediately before or after the @
    }
  }

  if (atCount !== 1) return false; // if more then one @ it returns false
  if (!dotAfterAt) return false; // if there was no '.' then it returns false

  if (str.length - lastDotIndex - 1 < 2) return false; //check if the TLD is valid or not (TLD valid if more than 1 character)

  if ((lastDotIndex - atIndex -1) < 3) return false;

  return true; // return true if the email passes all the conditions above
}

console.log(ValidateEmail("john.doe@gmail.com")); //true
console.log(ValidateEmail("john@doe@gmail.com")); //false
console.log(ValidateEmail("john@gmail.c")); //false
console.log(ValidateEmail("john@.com")); //false
console.log(ValidateEmail("john@a.com")); //false
console.log(ValidateEmail(".john@aty.com")); //false
console.log(ValidateEmail("@gmail.com")); //false

